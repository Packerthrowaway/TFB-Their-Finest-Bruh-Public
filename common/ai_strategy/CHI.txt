# befriend
# conquer
# antagonize
# build_ship
# build_army
# unit_ratio
# build_building
# research_tech
# garrison
# protect
# influence

CHI_unit_production = {
	allowed = { original_tag = CHI }
	enable = {
		always = yes
	}
	abort = {
		always = no
	}
	
	ai_strategy = {
		type = role_ratio
		id = garrison
		value = 0
	}


	ai_strategy = {
		type = role_ratio
		id = paratroopers
		value = 0
	}

	ai_strategy = {
		type = role_ratio
		id = mountaineers
		value = 0
	}

	ai_strategy = {
		type = role_ratio
		id = marines
		value = 0
	}

	ai_strategy = {
		type = role_ratio
		id = armor
		value = -10
	}

	ai_strategy = {
		type = role_ratio
		id = infantry
		value = 100
	}
	
	#Air unit factors
	ai_strategy = {
		type = unit_ratio
		id = fighter
		value = 0 # From 70 to 75
	}
	
	ai_strategy = {
		type = unit_ratio
		id = cas
		value = 0
	}
	
	ai_strategy = {
		type = unit_ratio
		id = tactical_bomber
		value = 0
	}
	
	ai_strategy = {
		type = unit_ratio
		id = strategic_bomber
		value = 0
	}
	
	ai_strategy = {
		type = unit_ratio
		id = naval_bomber
		value = 0
	}
	
	
	# Naval unit factors
	ai_strategy = {
		type = unit_ratio
		id = capital_ship
		value = 25 # from 15 to 25
	}

	ai_strategy = {
		type = unit_ratio
		id = submarine
		value = 40 #from 50 to 40
	}

	ai_strategy = {
		type = unit_ratio
		id = screen_ship
		value = 20
	}

	ai_strategy = {
		type = unit_ratio
		id = convoy
		value = 20
	}
	
	ai_strategy = {
		type = equipment_production_factor
		id = fighter
		value = 0
	}
	
	ai_strategy = {
		type = equipment_production_factor
		id = infantry
		value = 35
	}
	
	ai_strategy = {
		type = equipment_production_factor
		id = artillery
		value = 25
	}
	
	ai_strategy = {
		type = equipment_production_factor
		id = armor
		value = 0
	}
	
	ai_strategy = {
		type = ignore_army_incompetence
		value = 50
	}

	ai_strategy = {
		type = building_target
		id = arms_factory
		value = 500
	}
	
}

# CHI_dont_waste_on_offensive_air_early = {
# 	enable = {
# 		original_tag = CHI
# 		date < 1940.1.1
# 	}
# 	abort = {
# 		date > 1940.1.1
# 	}

# 	ai_strategy = {
# 		type = equipment_variant_production_factor
# 		id = tac_bomber_equipment
# 		value = -100
# 	}
	
# 	ai_strategy = {
# 		type = equipment_variant_production_factor
# 		id = strat_bomber_equipment
# 		value = -100
# 	}
# }



CHI_prio_military_even_at_peace = {
	allowed = { original_tag = CHI }
	enable = {
		always = yes
	}
	abort_when_not_enabled = yes
	
	ai_strategy = {
		type = added_military_to_civilian_factory_ratio
		value = 50
	}
	
}
	
CHI_dont_mess_with_the_soviets = {

	allowed = { original_tag = CHI }
	enable = {	
		NOT = { has_war_with = SOV }
	}
	
	abort = {
		has_war_with = SOV
	}

	ai_strategy = {
		type = contain
		id = "SOV"			
		value = -200
	}
}

CHI_some_safer_places_to_build = {
	allowed = { original_tag = CHI }
	enable = {
		always = yes
	}

	abort = {
		date > 1941.1.1
	}

	ai_strategy = {
        type = factory_build_score_factor
        target =  602
        value = 500
    }

	ai_strategy = {
        type = factory_build_score_factor
        target =  605
        value = 500
    }

	ai_strategy = {
        type = factory_build_score_factor
        target =  622
        value = 500
    }

	ai_strategy = {
        type = factory_build_score_factor
        target =  751
        value = 500
    }

	ai_strategy = {
        type = factory_build_score_factor
        target =  752
        value = 500
    }

	ai_strategy = {
        type = factory_build_score_factor
        target =  325
        value = 500
    }


}

CHI_you_should_be_prepared_for_war = {
	allowed = { 
		is_literally_china = yes
	}
	enable = {
		always = yes
	}
	abort_when_not_enabled = yes
	
	ai_strategy = {
        type = force_build_armies
        value = 100
    }
}

CHI_no_army_on_friendly_neighbors = {

	allowed = {
		original_tag = CHI 
	}
	abort_when_not_enabled = yes
	enable = {
		has_war_with = JAP
		JAP = { is_ai = no}
		MAN = { is_ai = no}
	}

	ai_strategy = {
		type = ignore 
		id = "MON"
		value = 500
	}

	ai_strategy = {
		type = ignore 
		id = "FRA"
		value = 500
	}

	ai_strategy = {
		type = ignore 
		id = "POR"
		value = 500
	}

	ai_strategy = {
		type = ignore 
		id = "ENG"
		value = 500
	}

	ai_strategy = {
		type = ignore 
		id = "RAJ"
		value = 500
	}
}


CHI_unit_production = {
	allowed = { original_tag = CHI }
	enable = {
		always = yes
	}
	abort = {
		always = no
	}
	
	ai_strategy = {
		type = role_ratio
		id = garrison
		value = 0
	}


	ai_strategy = {
		type = role_ratio
		id = paratroopers
		value = 0
	}

	ai_strategy = {
		type = role_ratio
		id = mountaineers
		value = 0
	}

	ai_strategy = {
		type = role_ratio
		id = marines
		value = 0
	}

	ai_strategy = {
		type = role_ratio
		id = armor
		value = -10
	}

	ai_strategy = {
		type = role_ratio
		id = infantry
		value = 100
	}
	
	#Air unit factors
	ai_strategy = {
		type = unit_ratio
		id = fighter
		value = 75 # From 70 to 75
	}
	
	ai_strategy = {
		type = unit_ratio
		id = cas
		value = 0
	}
	
	ai_strategy = {
		type = unit_ratio
		id = tactical_bomber
		value = 0
	}
	
	ai_strategy = {
		type = unit_ratio
		id = strategic_bomber
		value = 0
	}
	
	ai_strategy = {
		type = unit_ratio
		id = naval_bomber
		value = 0
	}
	
	
	# Naval unit factors
	ai_strategy = {
		type = unit_ratio
		id = capital_ship
		value = 25 # from 15 to 25
	}

	ai_strategy = {
		type = unit_ratio
		id = submarine
		value = 40 #from 50 to 40
	}

	ai_strategy = {
		type = unit_ratio
		id = screen_ship
		value = 20
	}

	ai_strategy = {
		type = unit_ratio
		id = convoy
		value = 20
	}
	
	ai_strategy = {
		type = ignore_army_incompetence
		value = 20
	}
}

CHI_dont_waste_on_offensive_air_early = {
	allowed = { original_tag = CHI }
	enable = {
		date < 1940.1.1
	}
	abort = {
		date > 1940.1.1
	}

	ai_strategy = {
		type = equipment_variant_production_factor
		id = medium_plane_airframe
		value = -100
	}
	
	ai_strategy = {
		type = equipment_variant_production_factor
		id = large_plane_airframe
		value = -100
	}
}

CHI_armored_production = {
	allowed = { original_tag = CHI }
	enable = {
		ai_wants_divisions > 0 #Decreasing the amount of tanks the AI wants
	}
	abort = {
		ai_wants_divisions < 1 #Decreasing the amount of tanks the AI wants
	}

	ai_strategy = {
		type = role_ratio
		id = armor
		value = 0
	}
}

CHI_dont_upgrade_to_weapons_2_too_early = {
	allowed = {
		original_tag = CHI
	}
	enable = {
		is_historical_focus_on = yes
		has_equipment = { infantry_equipment < 0 }
	}

	abort_when_not_enabled = yes

	ai_strategy = { # It's going to be disastrous for us to switch this up in early 37. Let's wait until we have more gun
		type = production_upgrade_desire_offset
		id = infantry_equipment_2
		value = -100
	}
}

CHI_highered_armored_production = {
	allowed = { original_tag = CHI }
	enable = {
		num_of_military_factories > 109
	}
	abort = {
		num_of_military_factories < 110
	}

	ai_strategy = {
		type = role_ratio
		id = armor
		value = 0
	}
}

CHI_prio_military_even_at_peace = {
	allowed = { original_tag = CHI }
	enable = {
		always = yes
	}
	abort_when_not_enabled = yes
	
	ai_strategy = {
		type = added_military_to_civilian_factory_ratio
		value = 50
	}
	
}
	
CHI_dont_mess_with_the_soviets = {

	allowed = { original_tag = CHI }
	enable = {	
		NOT = { has_war_with = SOV }
	}
	
	abort = {
		has_war_with = SOV
	}

	ai_strategy = {
		type = contain
		id = "SOV"			
		value = -200
	}
}

CHI_some_safer_places_to_build = {
	allowed = { original_tag = CHI }
	enable = {
		OR = {
			controls_state = 602
			controls_state = 605
		}
	}

	abort = {
		date > 1941.1.1
	}

	ai_strategy = {
        type = factory_build_score_factor
        target =  602
        value = 300
    }

	ai_strategy = {
        type = factory_build_score_factor
        target =  605
        value = 300
    }
}

CHI_some_safer_places_to_build_2 = {
	allowed = { original_tag = CHI }
	enable = {
		always = yes
	}

	abort = {
		date > 1941.1.1
	}

	ai_strategy = {
        type = factory_build_score_factor
        target =  748
        value = 300
    }

	ai_strategy = {
        type = factory_build_score_factor
        target =  603
        value = 300
    }

	ai_strategy = {
        type = factory_build_score_factor
        target =  750
        value = 300
    }
}

CHI_you_should_be_prepared_for_war = {
	allowed = { 
		is_literally_china = yes
		NOT = { has_dlc = "No Compromise, No Surrender"}
	}
	enable = {
		date < 1938.6.1
	}
	abort_when_not_enabled = yes
	
	ai_strategy = {
        type = force_build_armies
        value = 100
    }
}

CHI_buffer_in_mainland = {
	allowed = {
		NOT = { has_dlc = "No Compromise, No Surrender"}
		is_literally_china_not_prc = yes
	}
	enable = {
		date < 1941.1.1
	}
	abort_when_not_enabled = yes
	
	ai_strategy = {
		type = put_unit_buffers
		states = {
			620 #Mainland china, without coast. This should slow down japanese advance due to tendency for china to retreat in disarray.
			602
			600
			750
			603
			748
			605
		}
		ratio = 0.15
		area = asia
		subtract_invasions_from_need = no
		subtract_fronts_from_need = yes
	}
}

#We need to protect all of our northern front and coastline because Japan is *knock knock konishiwa* soon
CHI_buffer_on_northern_borders_and_coast = {
	allowed = {
		has_dlc = "No Compromise, No Surrender"
		is_literally_china_not_prc = yes
	}
	enable = {
		date < 1941.1.1
		OR = {
			original_tag = CHI
			is_in_faction_with = CHI
		}
		has_war = no
	}
	abort_when_not_enabled = yes
	
	ai_strategy = {
		type = put_unit_buffers
		states = {
			598
			607
			1034
			596
			595
			606
		}
		ratio = 0.2
		area = asia
		subtract_invasions_from_need = no
		subtract_fronts_from_need = yes
	}
}

#We need to have a buffer in interior states so we don't get steamrolled if Japan breaks through our front lines
CHI_buffer_in_interior_china = {
	allowed = {
		has_dlc = "No Compromise, No Surrender"
		is_literally_china_not_prc = yes
	}
	enable = {
		date < 1941.1.1
		OR = {
			original_tag = CHI
			is_in_faction_with = CHI
		}
	}
	abort_when_not_enabled = yes
	
	ai_strategy = {
		type = put_unit_buffers
		states = {
			1035
		}
		ratio = 0.1
		area = asia
		subtract_invasions_from_need = no
		subtract_fronts_from_need = yes
	}
}

#China shouldn't push that hard because Japan has other places to invade too
CHI_hunker_down_now  = {
	allowed = {
		original_tag = CHI
	}

	enable = {
		date < 1938.6.1
		has_war_with = JAP
		is_historical_focus_on = yes
		has_defensive_war = yes
	}

	abort_when_not_enabled = yes 

	ai_strategy = {
		type = front_control

		tag = JAP

		ratio = 0.35

		priority = 50
		ordertype = front
		execution_type = careful
	}

}

CHI_hunker_down_now_2  = {
	allowed = {
		original_tag = CHI
	}

	enable = {
		date > 1938.6.1
		has_war_with = JAP
		is_historical_focus_on = yes
		has_defensive_war = yes
	}

	abort_when_not_enabled = yes 

	ai_strategy = {
		type = front_control

		tag = JAP

		ratio = 0.35

		priority = 50
		ordertype = front
		execution_type = balanced
	}

}



CHI_dont_join_USA_if_not_democratic = {
	allowed = {
		WTT_is_chinese_country = yes 
	}

	enable = {
		WTT_is_chinese_country = yes 
		NOT = { has_government = democratic }
		USA = { has_government = democratic }
	}

	abort_when_not_enabled = yes 

	ai_strategy = {
		type =  alliance
		id = USA
		value = -250
	}

}

#### FORCE CONCENTRATION

# We defend all our country, right
CHI_aifc_incompetent_officers = {
	allowed = { original_tag = CHI }
	enable = {
		OR = {
			has_idea = CHI_incompetent_officers
			NOT = { has_completed_focus = CHI_serve_the_country_with_utmost_loyalty }
			NOT = { has_completed_focus = CHI_prepare_the_war_zones }
		}
	}
	
	abort_when_not_enabled = yes 

	ai_strategy = {
		type = force_concentration_factor
		value = -30  # if we have enough doctrines, we can do a little.... 
	}
}

#SEA

#The coast is a lost cause, so build inland instead
CHI_build_factories_inland = {
	allowed = {
		has_dlc = "No Compromise, No Surrender"
		original_tag = CHI
	}

	enable = {
		date < 1941.1.1
	}

	abort = {
		date > 1938.6.1
		NOT = {
			has_war_with = JAP
		}
	}

	#Build in Wuhan
	ai_strategy = {
		type = build_building
		id = arms_factory
		target = 1036
		value = 25
	}
	ai_strategy = {
		type = build_building
		id = industrial_complex
		target = 1036
		value = 25
	}
	#Build in Changde
	ai_strategy = {
		type = build_building
		id = arms_factory
		target = 750
		value = 25
	}
	ai_strategy = {
		type = build_building
		id = industrial_complex
		target = 750
		value = 25
	}
	#Build in Sichuan
	ai_strategy = {
		type = build_building
		id = arms_factory
		target = 605
		value = 25
	}
	ai_strategy = {
		type = build_building
		id = industrial_complex
		target = 605
		value = 25
	}
	#Build in Chengdu
	ai_strategy = {
		type = build_building
		id = arms_factory
		target = 1041
		value = 25
	}
	ai_strategy = {
		type = build_building
		id = industrial_complex
		target = 1041
		value = 25
	}
	#Build in Chongqing
	ai_strategy = {
		type = build_building
		id = arms_factory
		target = 1037
		value = 35
	}
	ai_strategy = {
		type = build_building
		id = industrial_complex
		target = 1037
		value = 35
	}
	#Build in Zunyi
	ai_strategy = {
		type = build_building
		id = arms_factory
		target = 748
		value = 15
	}
	ai_strategy = {
		type = build_building
		id = industrial_complex
		target = 748
		value = 15
	}
	#Build in Hubei
	ai_strategy = {
		type = build_building
		id = arms_factory
		target = 620
		value = 15
	}
	ai_strategy = {
		type = build_building
		id = industrial_complex
		target = 620
		value = 15
	}
	#Build in Hunan
	ai_strategy = {
		type = build_building
		id = arms_factory
		target = 602
		value = 15
	}
	ai_strategy = {
		type = build_building
		id = industrial_complex
		target = 602
		value = 15
	}
}

CHI_bog_them_down_and_war_zones_concentrations = {
	allowed = {
		original_tag = CHI
	}
	enable = {
		OR = {
			has_completed_focus = CHI_bog_them_down_in_the_centre
			has_completed_focus = CHI_prepare_the_war_zones
		}
		any_core_state = {
			has_state_flag = CHI_holding_state_mission_flag
		}
	}
	abort_when_not_enabled = yes
	
	ai_strategy = {
		type = front_unit_request
		state_trigger = {
			has_state_flag = CHI_holding_state_mission_flag
		}
		value = 50
	}
}

CHI_prioritize_coast_garrisons = {
	allowed = {
		is_literally_china = yes
	}
	enable = {
		date < 1941.1.1
		any_core_state = {
			is_coastal = yes
			is_fully_controlled_by = ROOT
		}
		OR = {
			has_war_with = JAP
			has_war_with = USA
			has_war_with = ENG
			has_war_with = FRA
		}
		CHI = {
			NOT = { has_completed_focus = CHI_strengthening_our_resolve }
		}
	}
	abort_when_not_enabled = yes
	
	ai_strategy = {
		type = garrison_reinforcement_priority
		value = 100
	}
}

CHI_prioritize_coast_garrisons_low_effort = { # Specifically for fasc-chi
	allowed = {
		original_tag = CHI 
	}
	enable = {
		date < 1941.1.1
		any_core_state = {
			is_coastal = yes
			is_fully_controlled_by = ROOT
		}
		OR = {
			has_war_with = JAP
			has_war_with = USA
			has_war_with = ENG
			has_war_with = FRA
		}
		has_completed_focus = CHI_strengthening_our_resolve 
	}
	abort_when_not_enabled = yes
	
	ai_strategy = {
		type = garrison_reinforcement_priority
		value = 50
	}
}

#CHI_defend_southern_china = {
#	allowed = {
#		OR = {
#			original_tag = SIC
#			original_tag = YUN
#			original_tag = GXC
#			original_tag = GDC
#		}
#	}
#	enable = {
#		is_in_faction_with = CHI
#		has_war = yes		
#		date < 1943.1.1
#	}
#	abort_when_not_enabled = yes
#	
#	ai_strategy = {
#		type = front_unit_request
#		id = JAP
#		value = 50
#		state_trigger = {
#			is_owned_by = CHI
#			OR = {
#				any_state_in = {
#					strategic_region = 164
#				}
#				any_state_in = {
#					strategic_region = 165
#				}
#				any_state_in = {
#					strategic_region = 248
#				}
#				any_state_in = {
#					strategic_region = 249
#				}
#			}
#		}
#	}
#}



#PRC wants to preserve its manpower because of... reasons - muahahaha
PRC_let_everyone_else_do_the_fighting = {
	allowed = {
		has_dlc = "No Compromise, No Surrender"
		original_tag = PRC
	}
	enable = {
		date < 1940.8.20
		is_in_faction_with = CHI
		NOT = {
			any_controlled_state = {
				any_neighbor_state = {
					controller = {
						has_war_with = PRC
					}
				}
			}
		}
	}
	abort_when_not_enabled = yes
	
	ai_strategy = {
		type = garrison
		value = 1000
	}
	ai_strategy = {
		type = front_unit_request
		value = -100
	}
}

#Building Mils and Infantry Equipment 0 is faster and cheaper and we gonna need everything we can get
PRC_military_factories_and_production = {
	allowed = { 
		original_tag = PRC 
	}
	enable = {
		date < 1939.1.1
	}
	abort_when_not_enabled = yes

	ai_strategy = { #All you need is guns - Guns is all you need
		type = building_target
		id = arms_factory
		value = 50
	}
	ai_strategy = { #Skip infantry_equipment_1 and jump straight to infantry_equipment_2 - we need quantity!
   		type = production_upgrade_desire_offset
 	 	id = infantry_equipment_1
  	 	value = -100
	}
}


PRC_focus_militias_early_game = {
	allowed = { 
		original_tag = PRC 
	}
	enable = {
		date < 1944.1.1
	}

	abort_when_not_enabled = yes
	ai_strategy = { #All you need is militias in early game
		type = role_ratio
		id = militias
		value = 300
	}

}

CHI_stop_disbanding_your_army_pre_war = {
	allowed = { 
		original_tag = CHI
		has_dlc = "No Compromise, No Surrender"
	}
	enable = {
		date < 1940.6.1
		has_war = no
	}
	abort_when_not_enabled = yes

	ai_strategy = {
		type = ai_wanted_divisions_factor
		value = 1000
	}
} 
CHI_stop_disbanding_your_army_during_war = {
	allowed = { 
		original_tag = CHI
		has_dlc = "No Compromise, No Surrender"
	}
	enable = {
		has_war = yes
	}
	abort_when_not_enabled = yes

	ai_strategy = {
		type = ai_wanted_divisions_factor
		value = 100
	}
}